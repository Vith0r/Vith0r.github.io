---
Tema Principal: Cybersegurança
tags:
  - Cybersegurança
  - segurança-informação
  - Análise-Dinâmica
related:
  - MALDEV
  - Análise-Estática
author: Vithor
---

Em alguns casos, quando vamos analisar um programa, pode ser de nosso interesse ver quais **importações** ele utiliza. Isso pode facilitar muito na hora da análise.

Nesse exemplo, vamos utilizar o [**Detect-It-Easy**](https://github.com/horsicq/Detect-It-Easy) para visualizar as **importações** que o programa utiliza.

<div align=center>
  <img alt="Detect-It-Easy" src="https://telegra.ph/file/2cb66380cb14dc4e5f956.gif">
</div>

Como podemos ver, existem algumas `APIs` "**maliciosas**" que o programa importa. Caso você não saiba quais `APIs` podem ser usadas em **malwares**, existe um site chamado [**MalApi.net**](https://malapi.io/) que pode ajudar:

<div align=center>
  <img alt="malapi" src="https://telegra.ph/file/5f2c4b53153a9cac349a8.gif">
</div>

Então, em casos como esse, podemos simplesmente marcar pontos de interrupção nas `APIs` que considerarmos necessárias. Neste exemplo, estarei utilizando o `API-Monitor`:

<div align=center>
  <img alt="API-Monitor" src="https://telegra.ph/file/4f887db990620c57bb4b9.gif">
</div>

Após definir os pontos de interrupção neste programa, vamos ver que teremos um ponto de interrupção na API `WriteProcessMemory`. Então, vamos apenas copiar esse endereço para poder fazer um **dump** do que foi escrito na memória do processo. Para isso, vamos utilizar o [**x64dbg**](https://x64dbg.com/):

<div align=center>
  <img alt="x64dbg" src="https://telegra.ph/file/945492cfa0c8d28e1b637.gif">
</div>

Após ter feito um **dump** da memória do que foi escrito, vamos analisar o conteúdo no [**VirusTotal**](https://www.virustotal.com/gui/home/upload):

<div align=center>
  <img alt="VirusTotal" src="https://telegra.ph/file/0e7a4032fc4519c14539a.gif">
</div>

Como podemos ver, conseguimos fazer o **dump** da memória do programa contendo o **malware** sem ao menos executá-lo. Devemos ter em mente que nem sempre conseguiremos identificar quais `APIs` o programa de fato utiliza, pois existem muitas técnicas para ocultar quais `APIs` o programa utiliza, como neste exemplo em que, ao tentarmos visualizar as `APIs` que o programa usa no [**Detect-It-Easy**](https://github.com/horsicq/Detect-It-Easy), não vamos ver nada de muito suspeito:

<div align=center>
  <img alt="Detect-It-Easy" src="https://telegra.ph/file/d8b6e8f109e394186aa8a.gif">
</div>

Agora, se definirmos pontos de interrupção no `API-Monitor` para algumas `APIs`, como **VirtualAlloc**/**VirtualProtect**, e executarmos o programa, vamos ver que de fato esse programa faz uso dessas `APIs`:

<div align=center>
  <img alt="API-Monitor" src="https://telegra.ph/file/c70adad91f41beab05099.gif">
</div>