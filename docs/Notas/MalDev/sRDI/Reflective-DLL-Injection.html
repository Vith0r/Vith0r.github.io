<!DOCTYPE html>
<html lang="pt"><head><title>Reflective Dll Injection</title><meta charset="utf-8"/><link rel="preconnect" href="https://fonts.googleapis.com"/><link rel="preconnect" href="https://fonts.gstatic.com"/><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700&amp;family=Satoshi Variable:ital,wght@0,400;0,600;1,400;1,600&amp;family=Azeret Mono:wght@400;600&amp;display=swap"/><link rel="preconnect" href="https://cdnjs.cloudflare.com" crossorigin="anonymous"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta name="og:site_name" content=" ※ Vithor "/><meta property="og:title" content="Reflective Dll Injection"/><meta property="og:type" content="website"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:title" content="Reflective Dll Injection"/><meta name="twitter:description" content="O Eco de uma Era: A Persistência do Reflective Loader Imagine uma técnica tão engenhosa que, por mais de uma década, dominou o cenário da segurança ofensiva."/><meta property="og:description" content="O Eco de uma Era: A Persistência do Reflective Loader Imagine uma técnica tão engenhosa que, por mais de uma década, dominou o cenário da segurança ofensiva."/><meta property="og:image:alt" content="O Eco de uma Era: A Persistência do Reflective Loader Imagine uma técnica tão engenhosa que, por mais de uma década, dominou o cenário da segurança ofensiva."/><meta property="twitter:domain" content="vith0r.github.io"/><meta property="og:url" content="https://vith0r.github.io/Notas/MalDev/sRDI/Reflective-DLL-Injection"/><meta property="twitter:url" content="https://vith0r.github.io/Notas/MalDev/sRDI/Reflective-DLL-Injection"/><link rel="icon" href="../../../static/icon.png"/><meta name="description" content="O Eco de uma Era: A Persistência do Reflective Loader Imagine uma técnica tão engenhosa que, por mais de uma década, dominou o cenário da segurança ofensiva."/><meta name="generator" content="Quartz"/><link href="../../../index.css" rel="stylesheet" type="text/css" spa-preserve/><style>.expand-button {
  position: absolute;
  display: flex;
  float: right;
  padding: 0.4rem;
  margin: 0.3rem;
  right: 0;
  color: var(--gray);
  border-color: var(--dark);
  background-color: var(--light);
  border: 1px solid;
  border-radius: 5px;
  opacity: 0;
  transition: 0.2s;
}
.expand-button > svg {
  fill: var(--light);
  filter: contrast(0.3);
}
.expand-button:hover {
  cursor: pointer;
  border-color: var(--secondary);
}
.expand-button:focus {
  outline: 0;
}

pre:hover > .expand-button {
  opacity: 1;
  transition: 0.2s;
}

#mermaid-container {
  position: fixed;
  contain: layout;
  z-index: 999;
  left: 0;
  top: 0;
  width: 100vw;
  height: 100vh;
  overflow: hidden;
  display: none;
  backdrop-filter: blur(4px);
  background: rgba(0, 0, 0, 0.5);
}
#mermaid-container.active {
  display: inline-block;
}
#mermaid-container > #mermaid-space {
  border: 1px solid var(--lightgray);
  background-color: var(--light);
  border-radius: 5px;
  position: fixed;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  height: 80vh;
  width: 80vw;
  overflow: hidden;
}
#mermaid-container > #mermaid-space > .mermaid-content {
  padding: 2rem;
  position: relative;
  transform-origin: 0 0;
  transition: transform 0.1s ease;
  overflow: visible;
  min-height: 200px;
  min-width: 200px;
}
#mermaid-container > #mermaid-space > .mermaid-content pre {
  margin: 0;
  border: none;
}
#mermaid-container > #mermaid-space > .mermaid-content svg {
  max-width: none;
  height: auto;
}
#mermaid-container > #mermaid-space > .mermaid-controls {
  position: absolute;
  bottom: 20px;
  right: 20px;
  display: flex;
  gap: 8px;
  padding: 8px;
  background: var(--light);
  border: 1px solid var(--lightgray);
  border-radius: 6px;
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
  z-index: 2;
}
#mermaid-container > #mermaid-space > .mermaid-controls .mermaid-control-button {
  display: flex;
  align-items: center;
  justify-content: center;
  width: 32px;
  height: 32px;
  padding: 0;
  border: 1px solid var(--lightgray);
  background: var(--light);
  color: var(--dark);
  border-radius: 4px;
  cursor: pointer;
  font-size: 16px;
  font-family: var(--bodyFont);
  transition: all 0.2s ease;
}
#mermaid-container > #mermaid-space > .mermaid-controls .mermaid-control-button:hover {
  background: var(--lightgray);
}
#mermaid-container > #mermaid-space > .mermaid-controls .mermaid-control-button:active {
  transform: translateY(1px);
}
#mermaid-container > #mermaid-space > .mermaid-controls .mermaid-control-button:nth-child(2) {
  width: auto;
  padding: 0 12px;
  font-size: 14px;
}
/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VSb290IjoiQzpcXFVzZXJzXFxyYW1pclxcRGVza3RvcFxccXJ0ejRcXHFydDRcXHF1YXJ0elxcY29tcG9uZW50c1xcc3R5bGVzIiwic291cmNlcyI6WyJtZXJtYWlkLmlubGluZS5zY3NzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0VBQ0U7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7O0FBRUE7RUFDRTtFQUNBOztBQUdGO0VBQ0U7RUFDQTs7QUFHRjtFQUNFOzs7QUFLRjtFQUNFO0VBQ0E7OztBQUlKO0VBQ0U7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTs7QUFFQTtFQUNFOztBQUdGO0VBQ0U7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7O0FBRUE7RUFDRTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTs7QUFFQTtFQUNFO0VBQ0E7O0FBR0Y7RUFDRTtFQUNBOztBQUlKO0VBQ0U7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTs7QUFFQTtFQUNFO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7O0FBRUE7RUFDRTs7QUFHRjtFQUNFOztBQUlGO0VBQ0U7RUFDQTtFQUNBIiwic291cmNlc0NvbnRlbnQiOlsiLmV4cGFuZC1idXR0b24ge1xuICBwb3NpdGlvbjogYWJzb2x1dGU7XG4gIGRpc3BsYXk6IGZsZXg7XG4gIGZsb2F0OiByaWdodDtcbiAgcGFkZGluZzogMC40cmVtO1xuICBtYXJnaW46IDAuM3JlbTtcbiAgcmlnaHQ6IDA7IC8vIE5PVEU6IHJpZ2h0IHdpbGwgYmUgc2V0IGluIG1lcm1haWQuaW5saW5lLnRzXG4gIGNvbG9yOiB2YXIoLS1ncmF5KTtcbiAgYm9yZGVyLWNvbG9yOiB2YXIoLS1kYXJrKTtcbiAgYmFja2dyb3VuZC1jb2xvcjogdmFyKC0tbGlnaHQpO1xuICBib3JkZXI6IDFweCBzb2xpZDtcbiAgYm9yZGVyLXJhZGl1czogNXB4O1xuICBvcGFjaXR5OiAwO1xuICB0cmFuc2l0aW9uOiAwLjJzO1xuXG4gICYgPiBzdmcge1xuICAgIGZpbGw6IHZhcigtLWxpZ2h0KTtcbiAgICBmaWx0ZXI6IGNvbnRyYXN0KDAuMyk7XG4gIH1cblxuICAmOmhvdmVyIHtcbiAgICBjdXJzb3I6IHBvaW50ZXI7XG4gICAgYm9yZGVyLWNvbG9yOiB2YXIoLS1zZWNvbmRhcnkpO1xuICB9XG5cbiAgJjpmb2N1cyB7XG4gICAgb3V0bGluZTogMDtcbiAgfVxufVxuXG5wcmUge1xuICAmOmhvdmVyID4gLmV4cGFuZC1idXR0b24ge1xuICAgIG9wYWNpdHk6IDE7XG4gICAgdHJhbnNpdGlvbjogMC4ycztcbiAgfVxufVxuXG4jbWVybWFpZC1jb250YWluZXIge1xuICBwb3NpdGlvbjogZml4ZWQ7XG4gIGNvbnRhaW46IGxheW91dDtcbiAgei1pbmRleDogOTk5O1xuICBsZWZ0OiAwO1xuICB0b3A6IDA7XG4gIHdpZHRoOiAxMDB2dztcbiAgaGVpZ2h0OiAxMDB2aDtcbiAgb3ZlcmZsb3c6IGhpZGRlbjtcbiAgZGlzcGxheTogbm9uZTtcbiAgYmFja2Ryb3AtZmlsdGVyOiBibHVyKDRweCk7XG4gIGJhY2tncm91bmQ6IHJnYmEoMCwgMCwgMCwgMC41KTtcblxuICAmLmFjdGl2ZSB7XG4gICAgZGlzcGxheTogaW5saW5lLWJsb2NrO1xuICB9XG5cbiAgJiA+ICNtZXJtYWlkLXNwYWNlIHtcbiAgICBib3JkZXI6IDFweCBzb2xpZCB2YXIoLS1saWdodGdyYXkpO1xuICAgIGJhY2tncm91bmQtY29sb3I6IHZhcigtLWxpZ2h0KTtcbiAgICBib3JkZXItcmFkaXVzOiA1cHg7XG4gICAgcG9zaXRpb246IGZpeGVkO1xuICAgIHRvcDogNTAlO1xuICAgIGxlZnQ6IDUwJTtcbiAgICB0cmFuc2Zvcm06IHRyYW5zbGF0ZSgtNTAlLCAtNTAlKTtcbiAgICBoZWlnaHQ6IDgwdmg7XG4gICAgd2lkdGg6IDgwdnc7XG4gICAgb3ZlcmZsb3c6IGhpZGRlbjtcblxuICAgICYgPiAubWVybWFpZC1jb250ZW50IHtcbiAgICAgIHBhZGRpbmc6IDJyZW07XG4gICAgICBwb3NpdGlvbjogcmVsYXRpdmU7XG4gICAgICB0cmFuc2Zvcm0tb3JpZ2luOiAwIDA7XG4gICAgICB0cmFuc2l0aW9uOiB0cmFuc2Zvcm0gMC4xcyBlYXNlO1xuICAgICAgb3ZlcmZsb3c6IHZpc2libGU7XG4gICAgICBtaW4taGVpZ2h0OiAyMDBweDtcbiAgICAgIG1pbi13aWR0aDogMjAwcHg7XG5cbiAgICAgIHByZSB7XG4gICAgICAgIG1hcmdpbjogMDtcbiAgICAgICAgYm9yZGVyOiBub25lO1xuICAgICAgfVxuXG4gICAgICBzdmcge1xuICAgICAgICBtYXgtd2lkdGg6IG5vbmU7XG4gICAgICAgIGhlaWdodDogYXV0bztcbiAgICAgIH1cbiAgICB9XG5cbiAgICAmID4gLm1lcm1haWQtY29udHJvbHMge1xuICAgICAgcG9zaXRpb246IGFic29sdXRlO1xuICAgICAgYm90dG9tOiAyMHB4O1xuICAgICAgcmlnaHQ6IDIwcHg7XG4gICAgICBkaXNwbGF5OiBmbGV4O1xuICAgICAgZ2FwOiA4cHg7XG4gICAgICBwYWRkaW5nOiA4cHg7XG4gICAgICBiYWNrZ3JvdW5kOiB2YXIoLS1saWdodCk7XG4gICAgICBib3JkZXI6IDFweCBzb2xpZCB2YXIoLS1saWdodGdyYXkpO1xuICAgICAgYm9yZGVyLXJhZGl1czogNnB4O1xuICAgICAgYm94LXNoYWRvdzogMCAycHggNHB4IHJnYmEoMCwgMCwgMCwgMC4xKTtcbiAgICAgIHotaW5kZXg6IDI7XG5cbiAgICAgIC5tZXJtYWlkLWNvbnRyb2wtYnV0dG9uIHtcbiAgICAgICAgZGlzcGxheTogZmxleDtcbiAgICAgICAgYWxpZ24taXRlbXM6IGNlbnRlcjtcbiAgICAgICAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7XG4gICAgICAgIHdpZHRoOiAzMnB4O1xuICAgICAgICBoZWlnaHQ6IDMycHg7XG4gICAgICAgIHBhZGRpbmc6IDA7XG4gICAgICAgIGJvcmRlcjogMXB4IHNvbGlkIHZhcigtLWxpZ2h0Z3JheSk7XG4gICAgICAgIGJhY2tncm91bmQ6IHZhcigtLWxpZ2h0KTtcbiAgICAgICAgY29sb3I6IHZhcigtLWRhcmspO1xuICAgICAgICBib3JkZXItcmFkaXVzOiA0cHg7XG4gICAgICAgIGN1cnNvcjogcG9pbnRlcjtcbiAgICAgICAgZm9udC1zaXplOiAxNnB4O1xuICAgICAgICBmb250LWZhbWlseTogdmFyKC0tYm9keUZvbnQpO1xuICAgICAgICB0cmFuc2l0aW9uOiBhbGwgMC4ycyBlYXNlO1xuXG4gICAgICAgICY6aG92ZXIge1xuICAgICAgICAgIGJhY2tncm91bmQ6IHZhcigtLWxpZ2h0Z3JheSk7XG4gICAgICAgIH1cblxuICAgICAgICAmOmFjdGl2ZSB7XG4gICAgICAgICAgdHJhbnNmb3JtOiB0cmFuc2xhdGVZKDFweCk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBTdHlsZSB0aGUgcmVzZXQgYnV0dG9uIGRpZmZlcmVudGx5XG4gICAgICAgICY6bnRoLWNoaWxkKDIpIHtcbiAgICAgICAgICB3aWR0aDogYXV0bztcbiAgICAgICAgICBwYWRkaW5nOiAwIDEycHg7XG4gICAgICAgICAgZm9udC1zaXplOiAxNHB4O1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9XG59XG4iXX0= */</style><link href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css" rel="stylesheet" type="text/css" spa-preserve/><script src="../../../prescript.js" type="application/javascript" spa-preserve></script><script type="application/javascript" spa-preserve>const fetchData = fetch("../../../static/contentIndex.json").then(data => data.json())</script><link rel="alternate" type="application/rss+xml" title="RSS Feed" href="https://vith0r.github.io/index.xml"/><meta property="og:image:width" content="1200"/><meta property="og:image:height" content="630"/><meta property="og:image" content="https://vith0r.github.io/Notas/MalDev/sRDI/Reflective-DLL-Injection-og-image.webp"/><meta property="og:image:url" content="https://vith0r.github.io/Notas/MalDev/sRDI/Reflective-DLL-Injection-og-image.webp"/><meta name="twitter:image" content="https://vith0r.github.io/Notas/MalDev/sRDI/Reflective-DLL-Injection-og-image.webp"/><meta property="og:image:type" content="image/.webp"/></head><body data-slug="Notas/MalDev/sRDI/Reflective-DLL-Injection"><div id="dappled-light"><div id="glow"></div><div id="glow-bounce"></div><div class="perspective"><div id="leaves"></div><div id="blinds"><div class="shutters"><div class="shutter"></div><div class="shutter"></div><div class="shutter"></div><div class="shutter"></div><div class="shutter"></div><div class="shutter"></div><div class="shutter"></div><div class="shutter"></div><div class="shutter"></div><div class="shutter"></div><div class="shutter"></div><div class="shutter"></div><div class="shutter"></div><div class="shutter"></div><div class="shutter"></div><div class="shutter"></div><div class="shutter"></div><div class="shutter"></div><div class="shutter"></div><div class="shutter"></div><div class="shutter"></div><div class="shutter"></div><div class="shutter"></div></div><div class="vertical"><div class="bar"></div><div class="bar"></div></div></div></div><div id="progressive-blur"><div></div><div></div></div></div><div id="quartz-root" class="page"><div id="quartz-body"><div class="left sidebar"><h2 class="page-title"><a href="../../.."> ※ Vithor </a></h2><div class="spacer mobile-only"></div><div class="flex-component" style="flex-direction: row; flex-wrap: nowrap; gap: 1rem;"><div style="flex-grow: 1; flex-shrink: 1; flex-basis: auto; order: 0; align-self: center; justify-self: center;"><div class="search"><button class="search-button"><p>Pesquisar</p><svg role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 19.9 19.7"><title>Search</title><g class="search-path" fill="none"><path stroke-linecap="square" d="M18.5 18.3l-5.4-5.4"></path><circle cx="8" cy="8" r="7"></circle></g></svg></button><div class="search-container"><div class="search-space"><input autocomplete="off" class="search-bar" name="search" type="text" aria-label="Pesquisar por algo" placeholder="Pesquisar por algo"/><div class="search-layout" data-preview="true"></div></div></div></div></div><div style="flex-grow: 0; flex-shrink: 1; flex-basis: auto; order: 0; align-self: center; justify-self: center;"><button class="darkmode"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" class="dayIcon" x="0px" y="0px" viewBox="0 0 35 35" style="enable-background:new 0 0 35 35" xml:space="preserve" aria-label="Tema escuro"><title>Tema escuro</title><path d="M6,17.5C6,16.672,5.328,16,4.5,16h-3C0.672,16,0,16.672,0,17.5    S0.672,19,1.5,19h3C5.328,19,6,18.328,6,17.5z M7.5,26c-0.414,0-0.789,0.168-1.061,0.439l-2,2C4.168,28.711,4,29.086,4,29.5    C4,30.328,4.671,31,5.5,31c0.414,0,0.789-0.168,1.06-0.44l2-2C8.832,28.289,9,27.914,9,27.5C9,26.672,8.329,26,7.5,26z M17.5,6    C18.329,6,19,5.328,19,4.5v-3C19,0.672,18.329,0,17.5,0S16,0.672,16,1.5v3C16,5.328,16.671,6,17.5,6z M27.5,9    c0.414,0,0.789-0.168,1.06-0.439l2-2C30.832,6.289,31,5.914,31,5.5C31,4.672,30.329,4,29.5,4c-0.414,0-0.789,0.168-1.061,0.44    l-2,2C26.168,6.711,26,7.086,26,7.5C26,8.328,26.671,9,27.5,9z M6.439,8.561C6.711,8.832,7.086,9,7.5,9C8.328,9,9,8.328,9,7.5    c0-0.414-0.168-0.789-0.439-1.061l-2-2C6.289,4.168,5.914,4,5.5,4C4.672,4,4,4.672,4,5.5c0,0.414,0.168,0.789,0.439,1.06    L6.439,8.561z M33.5,16h-3c-0.828,0-1.5,0.672-1.5,1.5s0.672,1.5,1.5,1.5h3c0.828,0,1.5-0.672,1.5-1.5S34.328,16,33.5,16z     M28.561,26.439C28.289,26.168,27.914,26,27.5,26c-0.828,0-1.5,0.672-1.5,1.5c0,0.414,0.168,0.789,0.439,1.06l2,2    C28.711,30.832,29.086,31,29.5,31c0.828,0,1.5-0.672,1.5-1.5c0-0.414-0.168-0.789-0.439-1.061L28.561,26.439z M17.5,29    c-0.829,0-1.5,0.672-1.5,1.5v3c0,0.828,0.671,1.5,1.5,1.5s1.5-0.672,1.5-1.5v-3C19,29.672,18.329,29,17.5,29z M17.5,7    C11.71,7,7,11.71,7,17.5S11.71,28,17.5,28S28,23.29,28,17.5S23.29,7,17.5,7z M17.5,25c-4.136,0-7.5-3.364-7.5-7.5    c0-4.136,3.364-7.5,7.5-7.5c4.136,0,7.5,3.364,7.5,7.5C25,21.636,21.636,25,17.5,25z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" class="nightIcon" x="0px" y="0px" viewBox="0 0 100 100" style="enable-background:new 0 0 100 100" xml:space="preserve" aria-label="Tema claro"><title>Tema claro</title><path d="M96.76,66.458c-0.853-0.852-2.15-1.064-3.23-0.534c-6.063,2.991-12.858,4.571-19.655,4.571  C62.022,70.495,50.88,65.88,42.5,57.5C29.043,44.043,25.658,23.536,34.076,6.47c0.532-1.08,0.318-2.379-0.534-3.23  c-0.851-0.852-2.15-1.064-3.23-0.534c-4.918,2.427-9.375,5.619-13.246,9.491c-9.447,9.447-14.65,22.008-14.65,35.369  c0,13.36,5.203,25.921,14.65,35.368s22.008,14.65,35.368,14.65c13.361,0,25.921-5.203,35.369-14.65  c3.872-3.871,7.064-8.328,9.491-13.246C97.826,68.608,97.611,67.309,96.76,66.458z"></path></svg></button></div><div style="flex-grow: 0; flex-shrink: 1; flex-basis: auto; order: 0; align-self: center; justify-self: center;"><button class="readermode"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" class="readerIcon" fill="currentColor" stroke="currentColor" stroke-width="0.2" stroke-linecap="round" stroke-linejoin="round" width="64px" height="64px" viewBox="0 0 24 24" aria-label="Modo leitor"><title>Modo leitor</title><g transform="translate(-1.8, -1.8) scale(1.15, 1.2)"><path d="M8.9891247,2.5 C10.1384702,2.5 11.2209868,2.96705384 12.0049645,3.76669482 C12.7883914,2.96705384 13.8709081,2.5 15.0202536,2.5 L18.7549359,2.5 C19.1691495,2.5 19.5049359,2.83578644 19.5049359,3.25 L19.5046891,4.004 L21.2546891,4.00457396 C21.6343849,4.00457396 21.9481801,4.28672784 21.9978425,4.6528034 L22.0046891,4.75457396 L22.0046891,20.25 C22.0046891,20.6296958 21.7225353,20.943491 21.3564597,20.9931534 L21.2546891,21 L2.75468914,21 C2.37499337,21 2.06119817,20.7178461 2.01153575,20.3517706 L2.00468914,20.25 L2.00468914,4.75457396 C2.00468914,4.37487819 2.28684302,4.061083 2.65291858,4.01142057 L2.75468914,4.00457396 L4.50368914,4.004 L4.50444233,3.25 C4.50444233,2.87030423 4.78659621,2.55650904 5.15267177,2.50684662 L5.25444233,2.5 L8.9891247,2.5 Z M4.50368914,5.504 L3.50468914,5.504 L3.50468914,19.5 L10.9478955,19.4998273 C10.4513189,18.9207296 9.73864328,18.5588115 8.96709342,18.5065584 L8.77307039,18.5 L5.25444233,18.5 C4.87474657,18.5 4.56095137,18.2178461 4.51128895,17.8517706 L4.50444233,17.75 L4.50368914,5.504 Z M19.5049359,17.75 C19.5049359,18.1642136 19.1691495,18.5 18.7549359,18.5 L15.2363079,18.5 C14.3910149,18.5 13.5994408,18.8724714 13.0614828,19.4998273 L20.5046891,19.5 L20.5046891,5.504 L19.5046891,5.504 L19.5049359,17.75 Z M18.0059359,3.999 L15.0202536,4 L14.8259077,4.00692283 C13.9889509,4.06666544 13.2254227,4.50975805 12.7549359,5.212 L12.7549359,17.777 L12.7782651,17.7601316 C13.4923805,17.2719483 14.3447024,17 15.2363079,17 L18.0059359,16.999 L18.0056891,4.798 L18.0033792,4.75457396 L18.0056891,4.71 L18.0059359,3.999 Z M8.9891247,4 L6.00368914,3.999 L6.00599909,4.75457396 L6.00599909,4.75457396 L6.00368914,4.783 L6.00368914,16.999 L8.77307039,17 C9.57551536,17 10.3461406,17.2202781 11.0128313,17.6202194 L11.2536891,17.776 L11.2536891,5.211 C10.8200889,4.56369974 10.1361548,4.13636104 9.37521067,4.02745763 L9.18347055,4.00692283 L8.9891247,4 Z"></path></g></svg></button></div></div><div class="explorer" data-behavior="link" data-collapsed="collapsed" data-savestate="true" data-data-fns="{&quot;order&quot;:[&quot;filter&quot;,&quot;map&quot;,&quot;sort&quot;],&quot;sortFn&quot;:&quot;(a,b)=>!a.isFolder&amp;&amp;!b.isFolder||a.isFolder&amp;&amp;b.isFolder?a.displayName.localeCompare(b.displayName,void 0,{numeric:!0,sensitivity:\&quot;base\&quot;}):!a.isFolder&amp;&amp;b.isFolder?1:-1&quot;,&quot;filterFn&quot;:&quot;node=>node.slugSegment!==\&quot;tags\&quot;&quot;,&quot;mapFn&quot;:&quot;node=>node&quot;}"><button type="button" class="explorer-toggle mobile-explorer hide-until-loaded" data-mobile="true" aria-controls="explorer-content"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide-menu"><line x1="4" x2="20" y1="12" y2="12"></line><line x1="4" x2="20" y1="6" y2="6"></line><line x1="4" x2="20" y1="18" y2="18"></line></svg></button><button type="button" class="title-button explorer-toggle desktop-explorer" data-mobile="false" aria-expanded="true"><h2>Explorador</h2><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="5 8 14 8" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="fold"><polyline points="6 9 12 15 18 9"></polyline></svg></button><div class="explorer-content" aria-expanded="false"><ul class="explorer-ul overflow" id="list-0"><li class="overflow-end"></li></ul></div><template id="template-file"><li><a href="#"></a></li></template><template id="template-folder"><li><div class="folder-container"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="5 8 14 8" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="folder-icon"><polyline points="6 9 12 15 18 9"></polyline></svg><div><button class="folder-button"><span class="folder-title"></span></button></div></div><div class="folder-outer"><ul class="content"></ul></div></li></template></div></div><div class="center"><div class="page-header"><div class="popover-hint"><nav class="breadcrumb-container" aria-label="breadcrumbs"><div class="breadcrumb-element"><a href="../../../">Home</a><p> ❯ </p></div><div class="breadcrumb-element"><a href="../../../Notas/">Notas</a><p> ❯ </p></div><div class="breadcrumb-element"><a href="../../../Notas/MalDev/">MalDev</a><p> ❯ </p></div><div class="breadcrumb-element"><a href="../../../Notas/MalDev/sRDI/">sRDI</a><p> ❯ </p></div><div class="breadcrumb-element"><a href>Reflective Dll Injection</a></div></nav><h1 class="article-title">Reflective Dll Injection</h1><p show-comma="true" class="content-meta"><time datetime="2025-07-29T07:24:59.000Z">29 de jul. de 2025</time><span>Leitura de 9 min</span></p><ul class="tags"><li><a href="../../../tags/Malware" class="internal tag-link">Malware</a></li><li><a href="../../../tags/Windows" class="internal tag-link">Windows</a></li><li><a href="../../../tags/Internals" class="internal tag-link">Internals</a></li></ul></div></div><article class="popover-hint"><h2 id="o-eco-de-uma-era-a-persistência-do-reflective-loader">O Eco de uma Era: A Persistência do Reflective Loader<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#o-eco-de-uma-era-a-persistência-do-reflective-loader" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<p>Imagine uma técnica tão engenhosa que, por mais de uma década, dominou o cenário da segurança ofensiva. Uma inovação que permitiu a execução de código malicioso diretamente na memória, contornando as defesas tradicionais e se tornando a espinha dorsal de ferramentas de ponta como <code>Cobalt Strike</code> e <code>Metasploit</code>. Essa é a história do <strong>Reflective DLL Injection (RDI)</strong>. Mas, em 2025, a pergunta que ecoa nos corredores da cibersegurança é inevitável: <span class="text-highlight">por que ainda nos apegamos a um método nascido em 2010, quando o campo de batalha digital se transformou radicalmente?</span></p>
<p>Este artigo não é apenas uma retrospectiva. É um mergulho profundo na crescente obsolescência do <code>Reflective DLL Injection</code> e suas variações, como o <code>Shellcode Reflective DLL Injection (sRDI)</code>. Vamos desvendar as razões pelas quais essa técnica, antes revolucionária, hoje se tornou um convite à “detecção”.</p>
<p>Mais importante, exploraremos o caminho para a próxima geração de implantes: soluções verdadeiramente <code>position-independent</code>, projetadas para evasão e discrição em um mundo dominado por sofisticadas soluções de <strong>Endpoint Detection and Response (EDR)</strong>.</p>
<hr/>
<h3 id="a-mecânica-do-carregamento-reflexivo">A Mecânica do Carregamento Reflexivo<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#a-mecânica-do-carregamento-reflexivo" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>No universo da segurança ofensiva, a busca por métodos que permitam a execução de código de forma furtiva é constante. Foi nesse contexto que o <strong>Reflective DLL Injection (RDI)</strong> surgiu como uma solução notavelmente engenhosa. Sua premissa era clara e poderosa: <span class="text-highlight">eliminar a dependência do carregador de DLLs do sistema operacional</span>. Isso significava que não haveria rastros no disco ou no registro, um avanço significativo para a discrição.</p>
<p>Em vez de um carregamento convencional, a própria DLL conteria a lógica para se mapear diretamente na memória do processo alvo. No coração dessa operação estava o <code>ReflectiveLoader</code>, uma função exportada. Essa função assumia a responsabilidade por tarefas complexas, como a resolução de realocações de memória, a importação de funções de outras bibliotecas e, finalmente, a chamada da função <code>DllMain</code> da DLL.</p>
<p>O processo era elegante: o conteúdo da DLL era injetado na memória (usando técnicas como <code>VirtualAlloc</code> ou <code>WriteProcessMemory</code>). Em seguida, uma thread era criada e sua execução direcionada para o offset onde o <code>ReflectiveLoader</code> residia. Este, por sua vez, reconstruía a estrutura <strong>PE (Portable Executable)</strong> da DLL em memória, ajustando seções, lidando com a <strong>Tabela de Endereços de Importação (IAT)</strong> e aplicando as permissões de memória adequadas.</p>
<hr/>
<h3 id="a-padronização-e-a-previsibilidade-inerente">A Padronização e a Previsibilidade Inerente<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#a-padronização-e-a-previsibilidade-inerente" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>Essa abordagem inovadora rapidamente se enraizou na cultura dos frameworks de <strong>Comando e Controle (C2)</strong>:</p>
<ul>
<li>O shellcode do <code>Meterpreter</code>, por exemplo, deixou de ser um simples bloco de código para se tornar uma DLL com um <code>ReflectiveLoader</code> embutido.</li>
<li>Ferramentas como <code>msfvenom</code>, <code>Donut</code> e <code>sRDI</code> surgiram para automatizar a geração de shellcodes a partir de DLLs, encapsulando toda a lógica reflexiva.</li>
<li>Frameworks como <code>Cobalt Strike</code> integraram o RDI em seus <em>beacons</em> e <em>stages</em>, solidificando-o como uma funcionalidade central para operações ofensivas.</li>
</ul>
<p>A proliferação de tutoriais, postagens em blogs e repositórios no GitHub, oferecendo <em>loaders</em> reflexivos prontos para uso, cimentou o RDI como uma técnica onipresente.</p>
<p>No entanto, <span class="text-highlight">essa mesma popularidade e a fidelidade com que o padrão foi replicado se tornaram, ironicamente, sua maior vulnerabilidade</span>. A previsibilidade do <em>stub</em> de loader, das sequências de chamadas de API e da ordem de operações transformou o que era uma vantagem em um <code>modus operandi</code> facilmente identificável.</p>
<h2 id="o-calcanhar-de-aquiles-do-rdi-previsibilidade-e-detecção-por-edrs">O Calcanhar de Aquiles do RDI: Previsibilidade e Detecção por EDRs<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#o-calcanhar-de-aquiles-do-rdi-previsibilidade-e-detecção-por-edrs" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<p>Em 2025, o cenário da segurança cibernética é drasticamente diferente. Soluções de <strong>Endpoint Detection and Response (EDR)</strong> empregam análises comportamentais e de memória cada vez mais sofisticadas. O que antes era uma técnica de evasão eficaz, hoje se tornou um alvo fácil para detecção. Mesmo com o uso de <em>wrappers</em>, <em>packers</em> e técnicas auxiliares como <code>module stomping</code>, a essência do RDI permanece “inalterada” e, consequentemente, vulnerável.</p>
<h3 id="assinaturas-em-memória-os-rastros-invisíveis-que-deixam-marcas">Assinaturas em Memória: Os Rastros Invisíveis que Deixam Marcas<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#assinaturas-em-memória-os-rastros-invisíveis-que-deixam-marcas" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>Mesmo após o mapeamento de uma DLL via RDI, artefatos residuais na memória podem ser utilizados para detecção. EDRs são capazes de escanear a memória em busca de padrões conhecidos, transformando o que deveria ser invisível em um rastro claro:</p>
<ul>
<li>
<p><strong>Headers PE Residuais:</strong> Embora o RDI se proponha a carregar a DLL sem tocar o disco, os cabeçalhos <strong>PE</strong> (como <code>IMAGE_DOS_HEADER</code> e <code>IMAGE_NT_HEADERS</code>) e suas estruturas internas (tabelas de importação e exportação, descritores de seção) permanecem na memória. EDRs podem identificar esses padrões, mesmo que ofuscados, como indicadores de atividade maliciosa.</p>
</li>
<li>
<p><strong>Stub do ReflectiveLoader:</strong> O próprio código do <code>ReflectiveLoader</code> possui uma sequência de instruções e uma lógica de reconstrução do PE que, apesar de variações mínimas, apresenta padrões detectáveis. A presença desse <em>stub</em> em regiões de memória com permissões de execução é um forte indicativo.</p>
</li>
<li>
<p><strong>Estruturas de Importação Visíveis:</strong> A resolução dinâmica de importações pelo <code>ReflectiveLoader</code> deixa as tabelas de importação visíveis na memória. Isso permite que EDRs identifiquem as APIs que a DLL está utilizando, revelando a intenção do implante.</p>
</li>
</ul>
<hr/>
<h3 id="a-citação-da-ibm-x-force-red-um-alerta-do-campo-de-batalha">A Citação da IBM X-Force Red: Um Alerta do Campo de Batalha<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#a-citação-da-ibm-x-force-red-um-alerta-do-campo-de-batalha" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>A equipe do <strong>IBM X-Force Red</strong>, em 10 de março de 2023, observou que a previsibilidade desses padrões permitiu que soluções comerciais criassem assinaturas eficazes contra Reflective Loaders. Eles afirmam:</p>
<blockquote>
<p>“<code>Cobalt Strike</code> continua sendo útil para simular adversários menos sofisticados. Para exercícios avançados, usamos loaders internos e C2s customizados.”</p>
</blockquote>
<p>Essa declaração não é apenas uma observação; é um alerta. Ela sublinha a obsolescência do RDI para operações de alto nível, onde a discrição é primordial. A técnica, que antes era uma inovação, hoje serve como um indicador de adversários menos sofisticados ou como um ponto de partida para detecção em ambientes bem defendidos.</p>
<h2 id="module-stomping-uma-solução-paliativa-que-não-resolve-o-problema-central">Module Stomping: Uma Solução Paliativa que Não Resolve o Problema Central<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#module-stomping-uma-solução-paliativa-que-não-resolve-o-problema-central" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<p>Para tentar contornar a detecção de alocações RWX, uma técnica comum empregada é o <code>module stomping</code>. Essa abordagem consiste em sobrescrever regiões executáveis de DLLs legítimas já carregadas no processo, em vez de alocar nova memória.</p>
<p>Embora o <code>module stomping</code> possa, de fato, evitar alguns gatilhos de EDR relacionados à alocação de memória, ele falha em resolver o problema estrutural inerente ao RDI. As seções sobrescritas ainda contêm estruturas PE, e a execução ainda segue a mesma ordem: <em>parsing</em> do PE, realocações e resolução de importações. O loader reflexivo, muitas vezes, permanece em texto claro. Ferramentas de análise de memória, como <code>PE-Sieve</code>, ainda conseguem detectar a modificação da DLL e extrair o <em>payload</em>.</p>
<p>Em essência, <span class="text-highlight">o module stomping apenas muda o &quot;local da injeção&quot;, mas não altera a natureza do que está sendo injetado</span>. Enquanto o <em>payload</em> continuar sendo uma DLL disfarçada com um <code>ReflectiveLoader</code>, ele permanecerá vulnerável à detecção por meio de análises comportamentais e de memória. É uma solução paliativa, não uma cura para a previsibilidade do RDI.</p>
<h2 id="position-independent">Position-Independent<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#position-independent" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<h3 id="além-da-dll-a-necessidade-de-uma-nova-abordagem">Além da DLL: A Necessidade de uma Nova Abordagem<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#além-da-dll-a-necessidade-de-uma-nova-abordagem" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>Para superar as limitações do RDI, a nova geração de implantes precisa ir além de ser uma DLL com um loader embutido. É imperativo que se tornem <strong>unidades de execução autocontidas</strong>, com o mínimo de dependência de estruturas externas e do carregador do sistema operacional. É aqui que o conceito de <code>implantes verdadeiramente position-independent</code> se torna crucial.</p>
<h3 id="características-de-um-implante-moderno">Características de um Implante Moderno<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#características-de-um-implante-moderno" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>Esses implantes representam uma evolução significativa no design de <em>malware</em>, buscando minimizar sua pegada em memória e seu comportamento detectável. As características que definem essa nova abordagem incluem:</p>
<ul>
<li>
<p><strong>Eliminação Completa de Headers PE:</strong> Ao contrário das DLLs reflexivas, que mantêm os cabeçalhos PE na memória, implantes verdadeiramente <code>position-independent</code> eliminam completamente essas estruturas. Isso reduz drasticamente a superfície de detecção por assinaturas baseadas em padrões de PE.</p>
</li>
<li>
<p><strong>Seções de Código Puras:</strong> Esses implantes contêm apenas código executável, sem a complexidade e os metadados de uma DLL tradicional. Isso resulta em uma pegada de memória menor e um comportamento mais discreto.</p>
</li>
<li>
<p><strong>Resolução de APIs via Hash (em tempo de execução):</strong> Em vez de depender de tabelas de importação visíveis, que podem ser facilmente analisadas por EDRs, implantes modernos resolvem os endereços das APIs dinamicamente em tempo de execução, geralmente por meio de <code>hashing de nomes de funções</code>. Isso torna a análise estática e a detecção por assinaturas muito mais difíceis.</p>
</li>
<li>
<p><strong>Gerenciamento de Contexto Manual e Instância Global:</strong> Um dos desafios em implantes <code>position-independent</code> é o gerenciamento de variáveis globais e o estado do implante. Soluções modernas, como o conceito de <code>&quot;instância global&quot;</code> visto em projetos como o <strong>Rustic64</strong>, permitem que o implante gerencie seu próprio estado e dados de forma eficiente e discreta, sem depender de estruturas globais facilmente identificáveis. Isso inclui o uso de alocadores de memória customizados que utilizam APIs de baixo nível, como a <strong>NT Heap API</strong>, para gerenciar a memória de forma mais controlada e evasiva.</p>
</li>
<li>
<p><strong>Menor Pegada de Memória:</strong> Ao eliminar estruturas desnecessárias e otimizar o código, o implante ocupa menos espaço na memória, tornando-o mais difícil de ser detectado por varreduras de memória.</p>
</li>
<li>
<p><strong>Comportamento Menos Suspeito:</strong> A ausência de alocações RWX explícitas (se o código for injetado em regiões de memória já executáveis) e a minimização de chamadas de API de alto nível podem reduzir os gatilhos comportamentais para EDRs. A ênfase é em operar de forma mais “nativa” e menos anômala dentro do processo alvo.</p>
</li>
</ul>
<p>Como destaca o pesquisador <em>5pider</em>:</p>
<blockquote>
<p>“Passei a escrever meus implantes de forma totalmente independente de posição, eliminando a necessidade de um stub de loader e qualquer header PE.”</p>
</blockquote>
<p>Essa mudança de paradigma significa que o shellcode não precisa mais “reconstruir nada”, ele já está pronto para ser executado de forma direta, eficiente e discreta.</p>
<h2 id="conclusão-o-legado-e-o-futuro">Conclusão: O Legado e o Futuro<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#conclusão-o-legado-e-o-futuro" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<p>O <strong>Reflective DLL Injection</strong> foi, e ainda é, sem dúvida, uma técnica essencial, e seu impacto na segurança ofensiva é inegável. No entanto, em 2025, com a proliferação de EDRs baseados em comportamento, rastreamento de <code>syscalls</code>, monitoramento de <strong>Event Tracing for Windows (ETW)</strong> e análises de memória aprofundadas, continuar a empregar o RDI da forma como foi concebido é, na maioria dos cenários, um convite à detecção.</p>
<p>A nova geração de operadores e desenvolvedores de <em>malware</em> já compreendeu essa realidade. É imperativo reformular a maneira como os implantes são desenvolvidos, abandonando a mentalidade de que <code>&quot;tudo é uma DLL&quot;</code> e adotando uma abordagem que enxerga cada implante como um código independente, consciente de si e do ambiente em que opera.</p>
<p>O futuro dos implantes reside na <strong>verdadeira independência de posição</strong>, na minimização de artefatos em memória e na adoção de comportamentos que se mesclam com as operações legítimas do sistema. Como a comunidade de segurança ofensiva continua a evoluir, a capacidade de inovar e adaptar-se às defesas modernas será o diferencial entre a detecção e a persistência.</p>
<blockquote>
<p>“Stop injecting DLLs. Start injecting implants.”</p>
</blockquote>
<h2 id="referências">Referências<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#referências" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<p>[1] IBM. (n.d.). <em>Defining the Cobalt Strike Reflective Loader</em>. IBM Think. <a href="https://www.ibm.com/think/x-force/defining-cobalt-strike-reflective-loader" class="external">https://www.ibm.com/think/x-force/defining-cobalt-strike-reflective-loader<svg aria-hidden="true" class="external-icon" style="max-width:0.8em;max-height:0.8em;" viewBox="0 0 512 512"><path d="M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z"></path></svg></a></p>
<p>[2] 5pider. (2024, January 27). <em>Modern implant design: position independent malware development</em>. 5pider.net. <a href="https://5pider.net/blog/2024/01/27/modern-shellcode-implant-design/" class="external">https://5pider.net/blog/2024/01/27/modern-shellcode-implant-design/<svg aria-hidden="true" class="external-icon" style="max-width:0.8em;max-height:0.8em;" viewBox="0 0 512 512"><path d="M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z"></path></svg></a></p>
<p>[3] Google Slides. (n.d.). <em>Demystifying AV/EDR Evasion (Public)</em>. <a href="https://docs.google.com/presentation/d/1qn-JkqwkYZCY391gZNmPZhTw9gYENIbhgRNJAg3dXf0/edit?slide=id.g3322b3aca21_0_11#slide=id.g3322b3aca21_0_11" class="external">https://docs.google.com/presentation/d/1qn-JkqwkYZCY391gZNmPZhTw9gYENIbhgRNJAg3dXf0/edit?slide=id.g3322b3aca21_0_11#slide=id.g3322b3aca21_0_11<svg aria-hidden="true" class="external-icon" style="max-width:0.8em;max-height:0.8em;" viewBox="0 0 512 512"><path d="M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z"></path></svg></a></p></article><hr/><div class="page-footer"></div></div><div class="right sidebar"><div class="graph"><h3>Visão de gráfico</h3><div class="graph-outer"><div class="graph-container" data-cfg="{&quot;drag&quot;:true,&quot;zoom&quot;:true,&quot;depth&quot;:1,&quot;scale&quot;:1.1,&quot;repelForce&quot;:0.5,&quot;centerForce&quot;:0.3,&quot;linkDistance&quot;:30,&quot;fontSize&quot;:0.6,&quot;opacityScale&quot;:1,&quot;showTags&quot;:true,&quot;removeTags&quot;:[],&quot;focusOnHover&quot;:false,&quot;enableRadial&quot;:false}"></div><button class="global-graph-icon" aria-label="Global Graph"><svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 55 55" fill="currentColor" xml:space="preserve"><path d="M49,0c-3.309,0-6,2.691-6,6c0,1.035,0.263,2.009,0.726,2.86l-9.829,9.829C32.542,17.634,30.846,17,29,17
                s-3.542,0.634-4.898,1.688l-7.669-7.669C16.785,10.424,17,9.74,17,9c0-2.206-1.794-4-4-4S9,6.794,9,9s1.794,4,4,4
                c0.74,0,1.424-0.215,2.019-0.567l7.669,7.669C21.634,21.458,21,23.154,21,25s0.634,3.542,1.688,4.897L10.024,42.562
                C8.958,41.595,7.549,41,6,41c-3.309,0-6,2.691-6,6s2.691,6,6,6s6-2.691,6-6c0-1.035-0.263-2.009-0.726-2.86l12.829-12.829
                c1.106,0.86,2.44,1.436,3.898,1.619v10.16c-2.833,0.478-5,2.942-5,5.91c0,3.309,2.691,6,6,6s6-2.691,6-6c0-2.967-2.167-5.431-5-5.91
                v-10.16c1.458-0.183,2.792-0.759,3.898-1.619l7.669,7.669C41.215,39.576,41,40.26,41,41c0,2.206,1.794,4,4,4s4-1.794,4-4
                s-1.794-4-4-4c-0.74,0-1.424,0.215-2.019,0.567l-7.669-7.669C36.366,28.542,37,26.846,37,25s-0.634-3.542-1.688-4.897l9.665-9.665
                C46.042,11.405,47.451,12,49,12c3.309,0,6-2.691,6-6S52.309,0,49,0z M11,9c0-1.103,0.897-2,2-2s2,0.897,2,2s-0.897,2-2,2
                S11,10.103,11,9z M6,51c-2.206,0-4-1.794-4-4s1.794-4,4-4s4,1.794,4,4S8.206,51,6,51z M33,49c0,2.206-1.794,4-4,4s-4-1.794-4-4
                s1.794-4,4-4S33,46.794,33,49z M29,31c-3.309,0-6-2.691-6-6s2.691-6,6-6s6,2.691,6,6S32.309,31,29,31z M47,41c0,1.103-0.897,2-2,2
                s-2-0.897-2-2s0.897-2,2-2S47,39.897,47,41z M49,10c-2.206,0-4-1.794-4-4s1.794-4,4-4s4,1.794,4,4S51.206,10,49,10z"></path></svg></button></div><div class="global-graph-outer"><div class="global-graph-container" data-cfg="{&quot;drag&quot;:true,&quot;zoom&quot;:true,&quot;depth&quot;:-1,&quot;scale&quot;:0.9,&quot;repelForce&quot;:0.5,&quot;centerForce&quot;:0.2,&quot;linkDistance&quot;:30,&quot;fontSize&quot;:0.6,&quot;opacityScale&quot;:1,&quot;showTags&quot;:true,&quot;removeTags&quot;:[],&quot;focusOnHover&quot;:true,&quot;enableRadial&quot;:true}"></div></div></div><div class="toc desktop-only"><button type="button" class="toc-header" aria-controls="toc-content" aria-expanded="true"><h3>Sumário</h3><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="fold"><polyline points="6 9 12 15 18 9"></polyline></svg></button><ul class="toc-content overflow" id="list-1"><li class="depth-0"><a href="#o-eco-de-uma-era-a-persistência-do-reflective-loader" data-for="o-eco-de-uma-era-a-persistência-do-reflective-loader">O Eco de uma Era: A Persistência do Reflective Loader</a></li><li class="depth-1"><a href="#a-mecânica-do-carregamento-reflexivo" data-for="a-mecânica-do-carregamento-reflexivo">A Mecânica do Carregamento Reflexivo</a></li><li class="depth-1"><a href="#a-padronização-e-a-previsibilidade-inerente" data-for="a-padronização-e-a-previsibilidade-inerente">A Padronização e a Previsibilidade Inerente</a></li><li class="depth-0"><a href="#o-calcanhar-de-aquiles-do-rdi-previsibilidade-e-detecção-por-edrs" data-for="o-calcanhar-de-aquiles-do-rdi-previsibilidade-e-detecção-por-edrs">O Calcanhar de Aquiles do RDI: Previsibilidade e Detecção por EDRs</a></li><li class="depth-1"><a href="#assinaturas-em-memória-os-rastros-invisíveis-que-deixam-marcas" data-for="assinaturas-em-memória-os-rastros-invisíveis-que-deixam-marcas">Assinaturas em Memória: Os Rastros Invisíveis que Deixam Marcas</a></li><li class="depth-1"><a href="#a-citação-da-ibm-x-force-red-um-alerta-do-campo-de-batalha" data-for="a-citação-da-ibm-x-force-red-um-alerta-do-campo-de-batalha">A Citação da IBM X-Force Red: Um Alerta do Campo de Batalha</a></li><li class="depth-0"><a href="#module-stomping-uma-solução-paliativa-que-não-resolve-o-problema-central" data-for="module-stomping-uma-solução-paliativa-que-não-resolve-o-problema-central">Module Stomping: Uma Solução Paliativa que Não Resolve o Problema Central</a></li><li class="depth-0"><a href="#position-independent" data-for="position-independent">Position-Independent</a></li><li class="depth-1"><a href="#além-da-dll-a-necessidade-de-uma-nova-abordagem" data-for="além-da-dll-a-necessidade-de-uma-nova-abordagem">Além da DLL: A Necessidade de uma Nova Abordagem</a></li><li class="depth-1"><a href="#características-de-um-implante-moderno" data-for="características-de-um-implante-moderno">Características de um Implante Moderno</a></li><li class="depth-0"><a href="#conclusão-o-legado-e-o-futuro" data-for="conclusão-o-legado-e-o-futuro">Conclusão: O Legado e o Futuro</a></li><li class="depth-0"><a href="#referências" data-for="referências">Referências</a></li><li class="overflow-end"></li></ul></div></div><footer class><p>Criado com <a href="https://quartz.jzhao.xyz/">Quartz v4.5.1</a> © 2025</p><ul><li><a href="https://github.com/Vith0r">GitHub</a></li><li><a href="https://discord.gg/cRFFHYye7t">Discord Community</a></li></ul></footer></div></div></body><script type="application/javascript">function n(){let t=this.parentElement;t.classList.toggle("is-collapsed");let e=t.getElementsByClassName("callout-content")[0];if(!e)return;let l=t.classList.contains("is-collapsed");e.style.gridTemplateRows=l?"0fr":"1fr"}function c(){let t=document.getElementsByClassName("callout is-collapsible");for(let e of t){let l=e.getElementsByClassName("callout-title")[0],s=e.getElementsByClassName("callout-content")[0];if(!l||!s)continue;l.addEventListener("click",n),window.addCleanup(()=>l.removeEventListener("click",n));let o=e.classList.contains("is-collapsed");s.style.gridTemplateRows=o?"0fr":"1fr"}}document.addEventListener("nav",c);
</script><script type="module">function f(i,e){if(!i)return;function r(o){o.target===this&&(o.preventDefault(),o.stopPropagation(),e())}function t(o){o.key.startsWith("Esc")&&(o.preventDefault(),e())}i?.addEventListener("click",r),window.addCleanup(()=>i?.removeEventListener("click",r)),document.addEventListener("keydown",t),window.addCleanup(()=>document.removeEventListener("keydown",t))}function y(i){for(;i.firstChild;)i.removeChild(i.firstChild)}var h=class{constructor(e,r){this.container=e;this.content=r;this.setupEventListeners(),this.setupNavigationControls(),this.resetTransform()}isDragging=!1;startPan={x:0,y:0};currentPan={x:0,y:0};scale=1;MIN_SCALE=.5;MAX_SCALE=3;cleanups=[];setupEventListeners(){let e=this.onMouseDown.bind(this),r=this.onMouseMove.bind(this),t=this.onMouseUp.bind(this),o=this.resetTransform.bind(this);this.container.addEventListener("mousedown",e),document.addEventListener("mousemove",r),document.addEventListener("mouseup",t),window.addEventListener("resize",o),this.cleanups.push(()=>this.container.removeEventListener("mousedown",e),()=>document.removeEventListener("mousemove",r),()=>document.removeEventListener("mouseup",t),()=>window.removeEventListener("resize",o))}cleanup(){for(let e of this.cleanups)e()}setupNavigationControls(){let e=document.createElement("div");e.className="mermaid-controls";let r=this.createButton("+",()=>this.zoom(.1)),t=this.createButton("-",()=>this.zoom(-.1)),o=this.createButton("Reset",()=>this.resetTransform());e.appendChild(t),e.appendChild(o),e.appendChild(r),this.container.appendChild(e)}createButton(e,r){let t=document.createElement("button");return t.textContent=e,t.className="mermaid-control-button",t.addEventListener("click",r),window.addCleanup(()=>t.removeEventListener("click",r)),t}onMouseDown(e){e.button===0&&(this.isDragging=!0,this.startPan={x:e.clientX-this.currentPan.x,y:e.clientY-this.currentPan.y},this.container.style.cursor="grabbing")}onMouseMove(e){this.isDragging&&(e.preventDefault(),this.currentPan={x:e.clientX-this.startPan.x,y:e.clientY-this.startPan.y},this.updateTransform())}onMouseUp(){this.isDragging=!1,this.container.style.cursor="grab"}zoom(e){let r=Math.min(Math.max(this.scale+e,this.MIN_SCALE),this.MAX_SCALE),t=this.content.getBoundingClientRect(),o=t.width/2,n=t.height/2,c=r-this.scale;this.currentPan.x-=o*c,this.currentPan.y-=n*c,this.scale=r,this.updateTransform()}updateTransform(){this.content.style.transform=`translate(${this.currentPan.x}px, ${this.currentPan.y}px) scale(${this.scale})`}resetTransform(){this.scale=1;let e=this.content.querySelector("svg");this.currentPan={x:e.getBoundingClientRect().width/2,y:e.getBoundingClientRect().height/2},this.updateTransform()}},C=["--secondary","--tertiary","--gray","--light","--lightgray","--highlight","--dark","--darkgray","--codeFont"],E;document.addEventListener("nav",async()=>{let e=document.querySelector(".center").querySelectorAll("code.mermaid");if(e.length===0)return;E||=await import("https://cdnjs.cloudflare.com/ajax/libs/mermaid/11.4.0/mermaid.esm.min.mjs");let r=E.default,t=new WeakMap;for(let n of e)t.set(n,n.innerText);async function o(){for(let s of e){s.removeAttribute("data-processed");let a=t.get(s);a&&(s.innerHTML=a)}let n=C.reduce((s,a)=>(s[a]=window.getComputedStyle(document.documentElement).getPropertyValue(a),s),{}),c=document.documentElement.getAttribute("saved-theme")==="dark";r.initialize({startOnLoad:!1,securityLevel:"loose",theme:c?"dark":"base",themeVariables:{fontFamily:n["--codeFont"],primaryColor:n["--light"],primaryTextColor:n["--darkgray"],primaryBorderColor:n["--tertiary"],lineColor:n["--darkgray"],secondaryColor:n["--secondary"],tertiaryColor:n["--tertiary"],clusterBkg:n["--light"],edgeLabelBackground:n["--highlight"]}}),await r.run({nodes:e})}await o(),document.addEventListener("themechange",o),window.addCleanup(()=>document.removeEventListener("themechange",o));for(let n=0;n<e.length;n++){let v=function(){let g=l.querySelector("#mermaid-space"),m=l.querySelector(".mermaid-content");if(!m)return;y(m);let w=c.querySelector("svg").cloneNode(!0);m.appendChild(w),l.classList.add("active"),g.style.cursor="grab",u=new h(g,m)},M=function(){l.classList.remove("active"),u?.cleanup(),u=null},c=e[n],s=c.parentElement,a=s.querySelector(".clipboard-button"),d=s.querySelector(".expand-button"),p=window.getComputedStyle(a),L=a.offsetWidth+parseFloat(p.marginLeft||"0")+parseFloat(p.marginRight||"0");d.style.right=`calc(${L}px + 0.3rem)`,s.prepend(d);let l=s.querySelector("#mermaid-container");if(!l)return;let u=null;d.addEventListener("click",v),f(l,M),window.addCleanup(()=>{u?.cleanup(),d.removeEventListener("click",v)})}});
</script><script src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/copy-tex.min.js" type="application/javascript"></script><script src="../../../postscript.js" type="module"></script></html>